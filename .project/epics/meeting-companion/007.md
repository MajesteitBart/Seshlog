---
name: Add Deepgram settings
status: closed
created: 2026-01-22T21:05:26Z
updated: 2026-01-23T11:15:36Z
github: pending-sync
depends_on: [001]
parallel: false
conflicts_with: []
completion_notes: Already done as part of 001 - Deepgram API key, model selection, and language settings all implemented
---

# Task: Add Deepgram settings

## Description

Add UI and backend support for configuring the Deepgram API key and selecting between transcription providers (Deepgram vs local Whisper/Parakeet).

## Acceptance Criteria

- [ ] Deepgram API key input field in Settings > Transcription
- [ ] Provider toggle: Deepgram / Local (Whisper) / Local (Parakeet)
- [ ] API key stored securely (not in plain text)
- [ ] Current provider displayed in recording UI
- [ ] Validation: warn if Deepgram selected but no API key
- [ ] Test connection button (optional)

## Technical Details

### Files to Modify

**Frontend:**
```
frontend/src/components/Settings/TranscriptSettings.tsx  # Add Deepgram fields
frontend/src/app/page.tsx                                # Show active provider
```

**Backend (Rust):**
```
frontend/src-tauri/src/database/repositories/setting.rs  # Store API key
frontend/src-tauri/src/api/api.rs                        # API key retrieval
```

### Settings UI

```tsx
// TranscriptSettings.tsx

// Provider Selection
<div className="space-y-2">
  <Label>Transcription Provider</Label>
  <Select value={provider} onValueChange={setProvider}>
    <SelectItem value="deepgram">Deepgram (Cloud)</SelectItem>
    <SelectItem value="localWhisper">Whisper (Local)</SelectItem>
    <SelectItem value="parakeet">Parakeet (Local)</SelectItem>
  </Select>
  <p className="text-sm text-muted-foreground">
    {provider === 'deepgram'
      ? 'Fast cloud transcription with speaker diarization'
      : 'Offline transcription, no API key needed'}
  </p>
</div>

// API Key Input (shown only for Deepgram)
{provider === 'deepgram' && (
  <div className="space-y-2">
    <Label>Deepgram API Key</Label>
    <div className="flex gap-2">
      <Input
        type="password"
        value={apiKey}
        onChange={(e) => setApiKey(e.target.value)}
        placeholder="Enter your Deepgram API key"
      />
      <Button variant="outline" onClick={testConnection}>
        Test
      </Button>
    </div>
    <p className="text-sm text-muted-foreground">
      Get your API key at <a href="https://console.deepgram.com" target="_blank">console.deepgram.com</a>
    </p>
  </div>
)}
```

### Storage

**Database schema** (existing `settings` table):
```sql
-- API keys stored encrypted per provider
INSERT INTO settings (key, value) VALUES
  ('transcript_provider', 'deepgram'),
  ('deepgram_api_key', 'encrypted:...');
```

**Rust API**:
```rust
#[tauri::command]
pub async fn save_deepgram_api_key(key: String) -> Result<(), String> {
    // Store encrypted in database
}

#[tauri::command]
pub async fn get_transcript_provider() -> Result<String, String> {
    // Return current provider
}
```

### Provider Indicator

Show active provider in main UI:
```tsx
// In recording controls or header
<Badge variant="outline">
  {provider === 'deepgram' ? '‚òÅÔ∏è Deepgram' : 'üíª Local'}
</Badge>
```

### Validation

```typescript
const handleStartRecording = async () => {
  if (provider === 'deepgram' && !apiKey) {
    toast.error('Please configure Deepgram API key in Settings');
    return;
  }
  // ... start recording
};
```

## Dependencies

- [ ] Task 001 (Deepgram provider) - need provider implemented to test

## Effort Estimate

- Size: S
- Hours: 2
- Parallel: false (requires Deepgram provider for testing)

## Definition of Done

- [ ] API key input field works
- [ ] Provider selection persists across app restarts
- [ ] API key stored securely (not visible in plain text)
- [ ] Validation prevents recording without API key when Deepgram selected
- [ ] Provider indicator visible during recording
- [ ] Code reviewed
