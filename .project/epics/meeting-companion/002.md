---
name: Create Obsidian file parser
status: closed
created: 2026-01-22T21:05:26Z
updated: 2026-01-23T11:24:15Z
github: pending-sync
depends_on: []
parallel: true
conflicts_with: [003]
completion_notes: Already implemented - all 16 tests pass, Tauri command registered
---

# Task: Create Obsidian file parser

## Description

Create a Rust module to parse Obsidian markdown meeting files, extracting YAML frontmatter and structured sections (Goals, Agenda, Context). This enables the app to load and display meeting prep content.

## Acceptance Criteria

- [ ] New `obsidian/` module created in `frontend/src-tauri/src/`
- [ ] YAML frontmatter parsed into structured data
- [ ] Markdown sections extracted by heading (## Prep, ### Goals, etc.)
- [ ] Tauri command `open_meeting_file(path)` returns `MeetingPrep` struct
- [ ] Graceful handling of malformed/missing sections
- [ ] File encoding handled correctly (UTF-8)

## Technical Details

### Files to Create

```
frontend/src-tauri/src/obsidian/
â”œâ”€â”€ mod.rs           # Module exports + MeetingPrep struct
â”œâ”€â”€ parser.rs        # Frontmatter + section extraction
â””â”€â”€ types.rs         # Data structures
```

### Data Structures

```rust
#[derive(Debug, Serialize, Deserialize)]
pub struct MeetingPrep {
    pub file_path: PathBuf,
    pub frontmatter: MeetingFrontmatter,
    pub title: String,
    pub goals: Vec<String>,      // Checkbox items
    pub agenda: Vec<String>,     // Numbered list items
    pub context: String,         // Raw markdown
    pub raw_content: String,     // Full file for later merge
}

#[derive(Debug, Serialize, Deserialize)]
pub struct MeetingFrontmatter {
    pub date: Option<String>,
    pub meeting_type: Option<String>,  // "type" in YAML
    pub attendees: Option<Vec<String>>,
    pub status: Option<String>,
}
```

### Parsing Logic

1. **Frontmatter Extraction**:
   - Find content between `---` markers at start of file
   - Parse with `serde_yaml`
   - Handle missing/optional fields gracefully

2. **Section Extraction**:
   - Find `## Prep` or `## Preparation` heading
   - Extract `### Goals` - parse checkbox items `- [ ]`
   - Extract `### Agenda` - parse numbered list
   - Extract `### Context` - raw markdown until next `##`

3. **Title Extraction**:
   - Find first `# ` heading after frontmatter

### Tauri Command

```rust
#[tauri::command]
pub async fn open_meeting_file(path: String) -> Result<MeetingPrep, String> {
    let content = tokio::fs::read_to_string(&path).await
        .map_err(|e| format!("Failed to read file: {}", e))?;
    parse_meeting_file(&path, &content)
        .map_err(|e| format!("Failed to parse file: {}", e))
}
```

### Dependencies to Add

```toml
# In frontend/src-tauri/Cargo.toml
serde_yaml = "0.9"
```

### Expected Input Format

```markdown
---
date: 2026-01-22
type: meeting
attendees: [Attendee A, Attendee B]
status: scheduled
---

# Meeting: Project Kickoff

## Prep
### Goals
- [ ] Align on timeline
- [ ] Assign workstreams

### Agenda
1. Introductions (5 min)
2. Scope review (15 min)

### Context
Background from previous conversations...
```

## Dependencies

- [ ] None - can start immediately

## Effort Estimate

- Size: S
- Hours: 3
- Parallel: true (conflicts only with 003 - same module)

## Definition of Done

- [ ] `obsidian/parser.rs` compiles without errors
- [ ] Unit tests for frontmatter parsing (valid, missing fields, malformed)
- [ ] Unit tests for section extraction
- [ ] Manual test: load real Obsidian meeting file
- [ ] Returns sensible defaults for missing sections
- [ ] Code reviewed

