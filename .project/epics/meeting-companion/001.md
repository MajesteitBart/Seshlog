---
name: Implement Deepgram WebSocket provider
status: closed
created: 2026-01-22T21:05:26Z
updated: 2026-01-23T11:10:18Z
github: pending-sync
depends_on: []
parallel: true
conflicts_with: []
---

# Task: Implement Deepgram WebSocket provider

## Description

Create a new Deepgram transcription provider that implements the existing `TranscriptionProvider` trait. This enables real-time streaming transcription with speaker diarization via Deepgram's WebSocket API.

## Acceptance Criteria

- [ ] New `deepgram/` module created in `frontend/src-tauri/src/`
- [ ] `DeepgramProvider` implements `TranscriptionProvider` trait
- [ ] WebSocket connection to `wss://api.deepgram.com/v1/listen` works
- [ ] Audio chunks (16kHz mono f32) stream to Deepgram
- [ ] Interim and final transcript results parsed correctly
- [ ] Speaker diarization labels extracted from responses
- [ ] `TranscriptResult` emitted with speaker info
- [ ] Graceful handling of connection errors/reconnection

## Technical Details

### Files to Create

```
frontend/src-tauri/src/deepgram/
├── mod.rs           # Module exports
├── provider.rs      # TranscriptionProvider implementation
└── websocket.rs     # WebSocket connection management
```

### Key Implementation Points

1. **Provider Implementation** (`provider.rs`):
   ```rust
   #[async_trait]
   impl TranscriptionProvider for DeepgramProvider {
       async fn transcribe(&self, audio: Vec<f32>, language: Option<String>)
           -> Result<TranscriptResult, TranscriptionError>;
       async fn is_model_loaded(&self) -> bool { true }  // Always "loaded"
       fn provider_name(&self) -> &'static str { "Deepgram" }
   }
   ```

2. **WebSocket URL Parameters**:
   ```
   wss://api.deepgram.com/v1/listen?
     encoding=linear16
     &sample_rate=16000
     &channels=1
     &diarize=true
     &interim_results=true
     &punctuate=true
   ```

3. **Audio Format**: Existing pipeline outputs 16kHz mono f32 - convert to linear16 (i16) for Deepgram

4. **Response Parsing**: Extract from JSON:
   - `channel.alternatives[0].transcript`
   - `channel.alternatives[0].words[].speaker`
   - `is_final` flag

### Dependencies to Add

```toml
# In frontend/src-tauri/Cargo.toml
tokio-tungstenite = { version = "0.21", features = ["native-tls"] }
```

### Integration Point

Update `audio/transcription/engine.rs` to add Deepgram case:
```rust
"deepgram" => {
    let api_key = config.api_key.ok_or("Deepgram API key required")?;
    let provider = Arc::new(DeepgramProvider::new(api_key));
    Ok(TranscriptionEngine::Provider(provider))
}
```

# developers.deepgram.com llms.txt

> Deepgram offers advanced speech recognition, text-to-speech, and audio intelligence solutions for developers to integrate innovative voice and audio processing functionalities into various applications.

- [Deepgram Live Transcription API](https://developers.deepgram.com/reference/listen-live): Provide detailed API documentation for Deepgram's real-time speech-to-text WebSocket service.
- [Deepgram Developer Support](https://developers.deepgram.com/support): Provide developer support resources and community links for Deepgram APIs and SDKs.
- [Data Privacy Compliance](https://developers.deepgram.com/docs/data-privacy-compliance): Explain Deepgram's data privacy compliance certifications and how to request related documentation.
- [Deepgram Custom Endpoints](https://developers.deepgram.com/reference/custom-endpoints): Guide to configuring Deepgram API with dedicated, EU, and self-hosted endpoints including SDK and cURL examples.
- [Deepgram SDK Features](https://developers.deepgram.com/sdks/sdk-features): Detail features and API support across Deepgram SDKs for various programming languages and functionalities.
- [Data Privacy Compliance](https://developers.deepgram.com/trust-security/data-privacy-compliance): Detail Deepgram's compliance with major data privacy and security standards and how to access related certifications.
- [Information Security & Privacy](https://developers.deepgram.com/trust-security/information-security-privacy): Detail Deepgram's comprehensive information security, privacy measures, and compliance frameworks to protect client data.
- [Deepgram Developer Hub](https://developers.deepgram.com/home): Provide documentation, SDKs, and resources for Deepgram's speech-to-text, text-to-speech, and voice agent APIs.
- [Deepgram API Rate Limits](https://developers.deepgram.com/reference/api-rate-limits): Detail API rate limits for Deepgram services across different plans and models.
- [Text-to-Speech REST API](https://developers.deepgram.com/docs/tts-rest): Provide documentation and guidance for Deepgram's Text-to-Speech REST API to convert text into audio.
- [Deepgram Text-to-Speech API](https://developers.deepgram.com/docs/text-to-speech): Guide for using Deepgram's Text-to-Speech REST API to convert text into audio with code examples and customization options.
- [Deepgram API Overview](https://developers.deepgram.com/reference/deepgram-api-overview): Provides detailed documentation and reference for using Deepgram's speech and text APIs.
- [API Authentication Guide](https://developers.deepgram.com/reference/authentication): Explain how to authenticate API requests using API keys and tokens for Deepgram services.
- [Deepgram Security Policy](https://developers.deepgram.com/docs/security-policy): Outline Deepgram's information security policies, standards, compliance, and incident response procedures.
- [Deepgram Self-Hosted Guide](https://developers.deepgram.com/docs/self-hosted-introduction): Guide for deploying and managing Deepgram's self-hosted speech AI solutions with setup, architecture, and security details.
- [Voice Agent Function Calling](https://developers.deepgram.com/docs/voice-agents-function-calling): Explain how to configure and use function calling in Deepgram's Voice Agent for LLM integration with external APIs.
- [Deepgram Changelog](https://developers.deepgram.com/changelog): To present updates and changes for Deepgram's API features and services.
- [Deepgram Support Resources](https://developers.deepgram.com/docs/support): Provide support resources and community links for Deepgram API users.
- [Deepgram TTS Voice Models](https://developers.deepgram.com/docs/tts-models): Details Deepgram's Aura text-to-speech voice models, languages, and usage examples for API integration.
- [Live Streaming Audio Guide](https://developers.deepgram.com/docs/live-streaming-audio): Guide to transcribe live streaming audio in real-time using Deepgram SDKs and API with code examples and tips.
- [Deepgram Listen API](https://developers.deepgram.com/reference/listen-file): Guide for using Deepgram API to transcribe audio files with customizable speech-to-text options.
- [Deepgram API Errors](https://developers.deepgram.com/docs/errors): Document Deepgram API error codes and provide guidance on handling them during development and production.
- [Deepgram Voice Agent API](https://developers.deepgram.com/reference/build-a-voice-agent): Guide developers to build and interact with a voice agent via Deepgram's WebSocket API.
- [Deepgram Developer Docs](https://developers.deepgram.com): Provide developers with documentation, SDKs, and tools for Deepgram's speech-to-text and text-to-speech APIs.
- [Deepgram Models Overview](https://developers.deepgram.com/docs/models-languages-overview): Detail Deepgram's speech-to-text model options, features, language support, and usage examples for developers.
- [Deepgram Text Intelligence](https://developers.deepgram.com/docs/text-intelligence): Guide to using Deepgram's text intelligence API for summarization, topic detection, intent recognition, and sentiment analysis.
- [Info Security & Privacy](https://developers.deepgram.com/docs/information-security-privacy-statement): Explain Deepgram's policies and measures for information security and data privacy compliance.
- [Deepgram Security Policy](https://developers.deepgram.com/trust-security/security-policy): Explain Deepgram's comprehensive security policies and practices to protect customer and company data.
- [Deepgram Audio Intelligence](https://developers.deepgram.com/docs/audio-intelligence): Guide to using Deepgram's API for audio transcription and analysis including summarization, topic detection, intent recognition, and sentiment analysis.
- [Pre-Recorded Audio Transcription](https://developers.deepgram.com/docs/pre-recorded-audio): Guide developers on using Deepgram API to transcribe pre-recorded audio files with code examples and limits.
- [Deepgram Voice Agent Guide](https://developers.deepgram.com/docs/voice-agent): Guide to build and configure a voice agent using Deepgram's Voice Agent API with example code.


## Dependencies

- [ ] None - can start immediately
- [ ] Deepgram API key for testing (user provides)

## Effort Estimate

- Size: M
- Hours: 4
- Parallel: true (no conflicts with other tasks)

## Definition of Done

- [ ] `deepgram/` module compiles without errors
- [ ] Unit test for audio format conversion (f32 → i16)
- [ ] Manual test: connect to Deepgram, send audio, receive transcript
- [ ] Speaker labels appear in transcript output
- [ ] Error handling for network failures
- [ ] Code reviewed
